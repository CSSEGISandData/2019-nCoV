a$`Country/Region`
b = a %>% group_by('Country/Region') %>%
summarise(Death_cum = sum(Deaths), n = n())
b
a$Deaths
b = a %>% group_by("Country/Region") %>%
summarise(Death_cum = sum(Deaths), n = n())
names(a)
names(a)[2] = "country"
names(a)
b = a %>% group_by("country") %>%
summarise(Death_cum = sum(Deaths), n = n())
b
b = a %>% group_by("country") %>%
dplyr::summarise(Death_cum = sum(Deaths), n = n())
b = a %>% group_by("country")
b
b[1]
b[2]
a$country
a$country = as.factor(a$country)
a$country
b = a %>% group_by("country") %>%
dplyr::summarise(Death_cum = sum(Deaths), n = n())
b
b = a %>% group_by("country") %>%
)
b = a %>% group_by("country")
b
mtcars
b = mtcars %>%
group_by(cyl, vs)
b
mtcars %>%
group_by(cyl, vs) %>%
summarise(cyl_n = n())
mtcars %>%
group_by(cyl) %>%
summarise(cyl_n = n())
b = as.data.frame(a) %>% group_by("country") %>%
summarise(Death_cum = sum(Deaths), n = n())
a
typeof(a)
typeof(mtcars)
b = as.data.frame(a) %>% group_by("country") %>%
summarise(Death_cum = sum(Deaths), n = n())
b
mtcars %>%
group_by(cyl) %>%
summarise(cyl_n = sum(wt))
a
matcars
mtcars
a
data.frame(a)
data.table(a)
a
b = as.data.frame(a) %>% group_by_at("country") %>%
summarise(Death_cum = sum(Deaths), n = n())
b
a$Deaths
View(b)
b = as.data.frame(a) %>% group_by_at("country") %>% summarise(Death_cum = sum(Deaths), n = n()) %>% ungroup
View(b)
b = as.data.frame(a) %>% group_by_at("country") %>% mutate(Death_cum = sum(Deaths), n = n()) %>% ungroup
View(b)
b = as.data.frame(a) %>% group_by_at("country") %>% summarise(Death_cum = sum(Deaths), n = n()) %>% ungroup
b = as.data.frame(a) %>% group_by_at("country") %>% summarise_at(Death_cum = sum(Deaths), n = n()) %>% ungroup
b = as.data.frame(a) %>% group_by_at("country") %>% summarise_at(.vars = "Deaths", .funs = sum) %>% ungroup
b
b = as.data.frame(a) %>% group_by_at("country") %>% summarise(Death_cum = sum(Deaths), n = n()) %>% ungroup
a$`Last Update`
b = a %>% mutate(`Last Update` = ymd(`Last Update`))%>% group_by_at("country") %>% summarise(Death_cum = sum(Deaths), n = n()) %>% ungroup
a %>% mutate(`Last Update` = ymd(`Last Update`))
library(lubridate)
a %>% mutate(`Last Update` = ymd(`Last Update`))
help("ymd")
a %>% mutate(new_date = round_date(Last Update, unit="week"))
a %>% mutate(new_date = round_date('Last Update', unit="week"))
a %>% mutate(new_date = round_date(`Last Update`, unit="week"))
b = a %>% mutate(new_date = round_date(`Last Update`, unit="week"))
b
b$new_date[1]
b$new_date[1] == b$new_date[2]
b$`Last Update`[1] == b$`Last Update`[2]
names(a)
b = a %>% mutate(date_new = round_date(`Last Update`, unit="week")) %>% group_by_at("country","date_new") %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
a %>% mutate(date_new = round_date(`Last Update`, unit="week"))
a
a %>% mutate(date_new = round_date(`Last Update`, unit="week"))
a
a %>% mutate_at(date_new = round_date(`Last Update`, unit="week"))
a %>% mutate(date_new = round_date(`Last Update`, unit="week"))
b = a %>% mutate(date_new = round_date(`Last Update`, unit="week"))
b
a %>% mutate(date_new = round_date(`Last Update`, unit="week"))
a %>% mutate(date_new = round_date(`Last Update`, unit="week")) %>% group_by_at("country","date_new") %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n())
a %>% mutate(date_new = round_date(`Last Update`, unit="week")) %>% group_by_at(.vars = ("country","date_new"))
a %>% mutate(date_new = round_date(`Last Update`, unit="week")) %>% group_by_at(.vars = c("country","date_new"))
a %>% mutate(date_new = round_date(`Last Update`, unit="week")) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
b = a %>% mutate(date_new = round_date(`Last Update`, unit="week")) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
b
View(b)
tbl
a = tbl[[20]]
a
a = tbl[[19]]
a
a = tbl[[20]]
b = a %>% mutate(date_new = round_date(`Last Update`, unit="week")) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
b = a %>% rename(`Country/Region` = "country") %>% mutate(date_new = round_date(`Last Update`, unit="week")) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
b = a %>% rename(Country/Region = country) %>% mutate(date_new = round_date(`Last Update`, unit="week")) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
b = a %>% rename('Country/Region' = country) %>% mutate(date_new = round_date(`Last Update`, unit="week")) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
b = a %>% rename(`Country/Region` = country) %>% mutate(date_new = round_date(`Last Update`, unit="week")) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
b = a %>% rename(`Country/Region` = country)
b = a %>% rename(country = `Country/Region`) %>% mutate(date_new = round_date(`Last Update`, unit="week")) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
View(b)
tbl <- list.files(path = path_data, pattern = "*.csv") %>% map(~read_csv(file.path(path_data,.)))
a = tbl[[20]]
b = a %>% rename(country = `Country/Region`) %>% mutate(date_new = round_date(`Last Update`, unit="week")) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
View(b)
a
a$`Last Update`
as.Date(a$`Last Update`)
b = a %>% rename(country = `Country/Region`) %>% mutate(date_new = as.Date(`Last Update`)) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
View(b)
tbl2 = tbl %>% rename(country = `Country/Region`) %>% mutate(date_new = as.Date(`Last Update`)) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
tbl2 = tbl %>% rename(country = `Country/Region`) %>% mutate(date_new = as.Date(`Last Update`)) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
b = map_dfr(tbl, ~ df %>% rename(country = `Country/Region`) %>% mutate(date_new = as.Date(`Last Update`)) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup)
tbl2 = lapply(tbl, rename(country = `Country/Region`) %>% mutate(date_new = as.Date(`Last Update`)) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup)
tbl
tbl2 = tbl %>% lapply(function(x){rename(country = `Country/Region`) %>% mutate(date_new = as.Date(`Last Update`)) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup})
tbl2 = map(tbl, ~ rename(country = `Country/Region`) %>% mutate(date_new = as.Date(`Last Update`)) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup)
tbl2 = map(tbl, ~ rename(country = `Country/Region`) %>% mutate(date_new = as.Date(`Last Update`)) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()))
tbl
names(tbl)
is.list(tbl)
tbl2 = map(tbl, ~ rename(country = c(`Country/Region`, Country_Region) %>% mutate(date_new = as.Date(`Last Update`)) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()))
)
tbl <- list.files(path = path_data, pattern = "*.csv") %>% map(~read_csv(file.path(path_data,.)) %%>% summarise_all)
tbl <- list.files(path = path_data, pattern = "*.csv") %>% map(~read_csv(file.path(path_data,.)) %>% summarise_all)
a
a %>% rename_(.dots=setNames(names(.), tolower(gsub("\\.", "_", names(.)))))
a %>% rename_(.dots=setNames(names(.), tolower(gsub("\\.", names(.)))))
a %>% rename_(.dots=setNames(names(.), tolower(gsub("\\.", "_", names(.)))))
data(iris)
iris
names(iris)
tolower( gsub("\\.", "_", names(iris) ) )
help(gsub)
letters
grep("[a-z]", letters)
a %>% grepl( "country" , names( a ) ) ]
a[,grepl( "country" , names( a ) ) ]
a %>% grepl( "country" , names( a ) )
a[,grepl( "country" , names( a ) ) ]
names(a)
a[,grep( "country" , names( a ) ) ]
a %>% select(contains("country"))
b = a %>% select(contains("country"))
b
View(b)
b = a %>% rename(country = contains("country"))
View(b)
fun1 <- function(df)
{
df = df %>% rename(country = contains("country"))
df1 = df %>% mutate(date_new = as.Date(`Last Update`)) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
}
tbl %>% map(fun1) %>% print()
fun1 <- function(df)
{
df = df %>% rename(country = contains("country"))
df1 = df %>% mutate(date_new = as.Date(`Last Update`)) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
}
tbl[[1]] %>% map(fun1)
fun1 <- function(df)
{
df = df %>% rename_vars(country = contains("country"))
df1 = df %>% mutate(date_new = as.Date(`Last Update`)) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
}
tbl %>% map(fun1)
fun1 <- function(df)
{
browser()
df = df %>% rename(country = contains("country"))
df1 = df %>% mutate(date_new = as.Date(`Last Update`)) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
}
tbl %>% map(fun1)
debugonce(map)
tbl %>% map(fun1)
View(df)
tbl %>% rename(country = contains("country")) %>% mutate(date_new = as.Date(`Last Update`)) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
a %>% rename(country = contains("country")) %>% mutate(date_new = as.Date(`Last Update`)) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
View(a)
View(b)
b = a %>% rename(country = contains("country")) %>% mutate(date_new = as.Date(`Last Update`))
View(b)
b = a %>% rename(country = contains("country")) %>% mutate(date_new = as.Date(`Last Update`)) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>%
ungroup
View(b)
a %>% rename(country = contains("country")) %>% mutate(date_new = as.Date(`Last Update`)) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
b = a %>% rename(country = contains("country")) %>% mutate(date_new = as.Date(`Last Update`)) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
View(b)
tbl %>% map(~fun1)
tbl %>% map(~fun1) %>% print()
b = tbl %>% map(~fun1)
b[[1]]
tbl %>% map(~fun1(.))
tbl %>% map(~fun1(.))
fun1 <- function(df)
{
df = df %>% rename(country = contains("country"))
df1 = df %>% mutate(date_new = as.Date(`Last Update`)) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
}
tbl %>% map(~fun1(.))
tbl %>% map(~fun1)
b = tbl %>% map(~fun1)
b
tbl %>% map(~fun1(.))
tbl %>% map(~fun1(.))
tbl %>% map(~fun1(.))
debugonce(as.Date)
debugonce(fun1)
tbl %>% map(~fun1(.))
missing(format)
x
charToDate(x)
help("ymd_hms")
fun1 <- function(df)
{
df = df %>% rename(country = contains("country"))
df1 = df %>% mutate(date_new = as.Date(ymd_hms(`Last Update`)) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
}
tbl %>% map(~fun1(.))
fun1 <- function(df)
{
df = df %>% rename(country = contains("country"))
df1 = df %>% mutate(date_new = as.Date(ymd_hms(`Last Update`))) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
}
tbl %>% map(~fun1(.))
debugonce(fun1)
debugonce(map)
fun1 <- function(df)
{
df = df %>% rename(country = contains("country"))
df1 = df %>% mutate(date_new = as.Date(ymd_hms(`Last Update`))) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
}
tbl %>% map(~fun1(.))
debugonce(fun1)
debugonce(map)
fun1 <- function(df)
{
df = df %>% rename(country = contains("country"))
df1 = df %>% mutate(date_new = as.Date(ymd_hms(`Last Update`))) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
}
tbl %>% map(~fun1)
debugonce(map)
tbl %>% map(~fun1)
debugonce(map_impl)
debugonce(map)
tbl %>% map(~fun1)
debugonce(map)
tbl %>% map(~fun1(.))
fun1 <- function(df)
{
df = df %>% rename(country = contains("country"))
df1 = df %>% mutate(date_new = as.Date(ymd_hms(Last Update))) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
}
tbl %>% map(~fun1(.))
fun1 <- function(df)
{
df = df %>% rename(country = contains("country"))
df1 = df %>% mutate(date_new = as.Date(ymd_hms(Last Update))) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
}
fun1 <- function(df)
{
df = df %>% rename(country = contains("country"))
df1 = df %>% mutate(date_new = as.Date(ymd_hms("Last Update"))) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
}
tbl %>% map(~fun1(.))
tbl2 =  tbl %>% map(~fun1(.))
View(tbl2)
tbl2[[1]]
debugonce(map)
debugonce(fun1)
tbl %>% map(~fun1(.))
View(df)
tbl2 =  tbl %>% map(~fun1(.)) %>% print()
debugonce(fun1)
fun1 <- function(df)
{
df = df %>% rename(country = contains("country"), date_old = 'Last Update' )
df1 = df %>% mutate(date_new = as.Date(ymd_hms(date_old)) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
}
fun1 <- function(df)
{
df = df %>% rename(country = contains("country"), date_old = "Last Update")
df1 = df %>% mutate(date_new = as.Date(ymd_hms(date_old)) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
}
fun1 <- function(df)
{
df = df %>% rename(country = contains("country"), date_old = contains("Last Update"))
df1 = df %>% mutate(date_new = as.Date(ymd_hms(date_old)) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
}
fun1 <- function(df)
{
df = df %>% rename(country = contains("country"))
df1 = df %>% mutate(date_new = as.Date(ymd_hms(date_old)) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
}
fun1 <- function(df)
{
df = df %>% rename(country = contains("country"))
df1 = df %>% mutate(date_new = as.Date(ymd_hms(date_old)) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
}
fun1 <- function(df)
{
df = df %>% rename(country = contains("country"))
df1 = df %>% mutate(date_new = as.Date(ymd_hms("Last Update"))) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
}
fun1 <- function(df)
{
df = df %>% rename(country = contains("country"), date_old = contains("Last Update"))
df1 = df %>% mutate(date_new = as.Date(ymd_hms(date_old)) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum
= sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
}
fun1 <- function(df)
{
df = df %>% rename(country = contains("country"), date_old = contains("Last Update"))
df1 = df %>% mutate(date_new = as.Date(ymd_hms(date_old)) %>% group_by_at(.vars = c("country","date_new")) %>%
summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered)) %>% ungroup
}
fun1 <- function(df)
{
df = df %>% rename(country = contains("country"))
df1 = df %>% mutate(date_new = as.Date(ymd_hms(date_old)) %>% group_by_at(.vars = c("country","date_new")) %>%
summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered)) %>% ungroup
}
fun1 <- function(df)
{
df = df %>% rename(country = contains("country"))
df1 = df %>% mutate(date_new = as.Date(ymd_hms("date_old")) %>% group_by_at(.vars = c("country","date_new")) %>%
summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered)) %>% ungroup
}
fun1 <- function(df)
{
df = df %>% rename(country = contains("country"), date_old = contains("Last Update"))
df1 = df %>% mutate(date_new = as.Date(ymd_hms(date_old))) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
}
debugonce(fun1)
debugonce(map)
tbl2 =  tbl %>% map(~fun1(.))
View(df)
debugonce(map)
debugonce(fun1)
tbl2 =  tbl %>% map(~fun1(.))
df %>% mutate(date_new = as.Date(ymd_hms(date_old)))
tbl[[1]]
tbl[[2]]
tbl[[3]]
tbl[[4]]
fun1 <- function(df)
{
df = df %>% rename(country = contains("country"))
df1 = df %>% mutate(date_new = as.Date(ymd_hms("Last Update"))) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed, na.rm=T), Death_cum = sum(Deaths, na.rm=T), Recovered_cum = sum(Recovered, na.rm=T),  n = n()) %>% ungroup
}
tbl2 =  tbl %>% map(~fun1(.))
View(tbl2)
tbl2[[1]]
debugonce(fun1)
debugonce(map)
tbl2 =  tbl %>% map(~fun1(.))
df %>% mutate(date_new = as.Date(ymd_hms("Last Update")))
fun1 <- function(df)
{
df = df %>% rename(country = contains("country"), date_old = contains("Last Update"))
df1 = df %>% mutate(date_new = as.Date(ymd_hms(date_old))) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
}
tbl2 =  tbl %>% map(~fun1(.))
debugonce(fun1)
debugonce(map)
tbl2 =  tbl %>% map(~fun1(.))
df %>% mutate(date_new = as.Date(ymd_hms(date_old)))
help("ymd_hms")
fun1 <- function(df)
{
df = df %>% rename(country = contains("country"), date_old = contains("Last Update"))
df1 = df %>% mutate(date_new = as.Date(lubridate::ymd_hms(date_old))) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
}
tbl2 =  tbl %>% map(~fun1(.))
debugonce(fun1)
debugonce(map)
tbl2 =  tbl %>% map(~fun1(.))
df1 = df %>% mutate(date_new = as.Date(lubridate::ymd_hms(date_old)))
df1[[1]]
df1
df %>% mutate(date_new = as.Date(date_old))
is.Date(df$date_old)
as.Date(df$date_old)
is.Date(df$date_old)
a
a$`Last Update`
is.Date(a$`Last Update`)
as.Date(a$`Last Update`)
as.Date(tbl[[1]]$`Last Update`)
tbl[[1]]
as.Date(tbl[[20]]$`Last Update`)
as.Date(tbl[[21]]$`Last Update`)
as.Date(tbl[[2]]$`Last Update`)
as.Date(tbl[[3]]$`Last Update`)
as.Date(tbl[[4]]$`Last Update`)
as.Date(tbl[[5]]$`Last Update`)
as.Date(tbl[[6]]$`Last Update`)
as.Date(tbl[[15]]$`Last Update`)
as.Date(tbl[[10]]$`Last Update`)
as.Date(tbl[[11]]$`Last Update`)
as.Date(tbl[[12]]$`Last Update`)
tbl[[11]]
format(tbl[[12]]$`Last Update`)
format(tbl[[11]]$`Last Update`)
format(tbl[[1]]$`Last Update`)
format.Date(tbl[[1]]$`Last Update`)
format(tbl[[1]]$`Last Update`)
format.POSIXlt(tbl[[1]]$`Last Update`)
tbl[[1]]$`Last Update`
tbl[[20]]$`Last Update`
tbl2 = tbl[-1:19]
tbl2 = tbl[-c(1:19)]
fun1 <- function(df)
{
df = df %>% rename(country = contains("country"), date_old = contains("Last Update"))
df1 = df %>% mutate(date_new = as.Date(lubridate::ymd_hms(date_old))) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
}
tbl3 =  tbl2 %>% map(~fun1(.))
debugonce(fun1)
debugonce(map)
tbl3 =  tbl2 %>% map(~fun1(.))
debugonce(fun1)
debugonce(map)
tbl3 =  tbl2 %>% map(~fun1(.))
df = df %>% rename(country = contains("country"), date_old = contains("Last Update"))
View(df)
fun1 <- function(df)
{
df = df %>% rename(country = contains("country"), date_old = contains("Last Update"))
df1 = df %>% mutate(date_new = as.Date(lubridate::ymd_hms(date_old))) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
}
debugonce(fun1)
debugonce(map)
tbl3 =  tbl2 %>% map(~fun1(.))
df = df %>% rename(country = contains("country"), date_old = contains("Last Update"))
tbl2[[1]]
tbl2[[2]]
path_data = paste0("D:/Oulhaj/4_Research/00000_My_Projects/COVID-19/csse_covid_19_data/csse_covid_19_daily_reports/")
#C. Load Global Functions##
tbl <- list.files(path = path_data, pattern = "*.csv") %>% map(~read_csv(file.path(path_data,.)))
a = tbl[[20]]
tbl %>% map(~fun1)
tbl2 = tbl[-c(1:19)]
tbl2[[1]]
fun1 <- function(df)
{
df = df %>% rename(country = contains("country"), date_old = contains("Last Update"))
df1 = df %>% mutate(date_new = as.Date(lubridate::ymd_hms(date_old))) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
}
debugonce(fun1)
debugonce(map)
tbl3 =  tbl2 %>% map(~fun1(.))
df = df %>% rename(country = contains("country"), date_old = contains("Last Update"))
tbl3 =  tbl2 %>% map(~fun1(.))
debugonce(fun1)
debugonce(map)
tbl2 %>% map(~fun1(.))
df = df %>% rename(country = contains("country"), date_old = contains("Last Update"))
df
df1 = df %>% mutate(date_new = as.Date(lubridate::ymd_hms(date_old)))
df1
df1 = df %>% mutate(date_new = as.Date(lubridate::ymd_hms(date_old))) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
df1
rlang::last_error()
rlang::last_trace()
fun1 <- function(df)
{
df = df %>% rename(country = contains("country"), date_old = contains("Last Update"))
df1 = df %>% mutate(date_new = as.Date(lubridate::ymd_hms(date_old))) %>% group_by_at(.vars = c("country","date_new")) %>% summarise(Confirmed_cum = sum(Confirmed), Death_cum = sum(Deaths), Recovered_cum = sum(Recovered),  n = n()) %>% ungroup
}
fun1(tbl[[1]])
debugonce(fun1)
fun1(tbl[[1]])
debugonce(fun1)
fun1(tbl[[1]])
df
df1 = df %>% mutate(date_new = as.Date(lubridate::ymd_hms(date_old)))
debugonce(fun1)
fun1(tbl2[[1]])
df1 = df %>% mutate(date_new = as.Date(lubridate::ymd_hms(date_old)))
d = fun1(tbl2[[1]])
d
tbl2
tbl2[1:2] %>% map(~fun1(.))
tbl2[1:10] %>% map(~fun1(.))
tbl2[1:20] %>% map(~fun1(.))
tbl2[1:50] %>% map(~fun1(.))
tbl2[1:40] %>% map(~fun1(.))
tbl2[40:45] %>% map(~fun1(.))
tbl2[40] %>% map(~fun1(.))
tbl2[41] %>% map(~fun1(.))
tbl2[42] %>% map(~fun1(.))
debugonce(fun1)
d = fun1(tbl2[[42]])
df = df %>% rename(country = contains("country"), date_old = contains("Last Update"))
tbl2[[42]]
